{% extends "layout.html" %}

{% block title %}إعدادات النظام - الحصة{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">إعدادات النظام</h1>
    </div>

    <!-- Content Row -->
    <div class="row">
        <div class="col-xl-8">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">الإعدادات العامة</h6>
                </div>
                <div class="card-body">
                    <form action="{{ url_for('admin.settings') }}" method="post">
                        <div class="form-group">
                            <label for="system_name">اسم النظام</label>
                            <input type="text" class="form-control" id="system_name" name="system_name" value="الحصة" required>
                        </div>
                        <div class="form-group">
                            <label for="system_description">وصف النظام</label>
                            <textarea class="form-control" id="system_description" name="system_description" rows="3">منصة تعليمية متكاملة لإدارة العملية التعليمية بكفاءة</textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="default_language">اللغة الافتراضية</label>
                                <select class="form-control" id="default_language" name="default_language">
                                    <option value="ar" selected>العربية</option>
                                    <option value="en">الإنجليزية</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="default_currency">العملة الافتراضية</label>
                                <select class="form-control" id="default_currency" name="default_currency">
                                    <option value="SAR" selected>ريال سعودي (SAR)</option>
                                    <option value="USD">دولار أمريكي (USD)</option>
                                    <option value="EUR">يورو (EUR)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="trial_days">فترة التجربة المجانية (أيام)</label>
                                <input type="number" class="form-control" id="trial_days" name="trial_days" value="14" min="0" required>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="max_file_size">الحد الأقصى لحجم الملفات (ميجابايت)</label>
                                <input type="number" class="form-control" id="max_file_size" name="max_file_size" value="16" min="1" required>
                            </div>
                        </div>
                        <hr>
                        <h6 class="font-weight-bold mb-3">إعدادات المظهر</h6>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="primary_color">اللون الرئيسي</label>
                                <input type="color" class="form-control" id="primary_color" name="primary_color" value="#4e73df">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="secondary_color">اللون الثانوي</label>
                                <input type="color" class="form-control" id="secondary_color" name="secondary_color" value="#1cc88a">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="logo_url">رابط الشعار</label>
                            <input type="text" class="form-control" id="logo_url" name="logo_url" value="/static/img/logo.png">
                        </div>
                        <hr>
                        <h6 class="font-weight-bold mb-3">إعدادات التواصل</h6>
                        <div class="form-group">
                            <label for="contact_email">البريد الإلكتروني للتواصل</label>
                            <input type="email" class="form-control" id="contact_email" name="contact_email" value="support@alhesa.com">
                        </div>
                        <div class="form-group">
                            <label for="contact_phone">رقم الهاتف للتواصل</label>
                            <input type="text" class="form-control" id="contact_phone" name="contact_phone" value="+966 55 555 5555">
                        </div>
                        <div class="form-group text-center mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> حفظ الإعدادات
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-xl-4">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">إعدادات متقدمة</h6>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <button class="btn btn-warning btn-block mb-2" data-toggle="modal" data-target="#clearCacheModal">
                            <i class="fas fa-broom"></i> مسح ذاكرة التخزين المؤقت
                        </button>
                        <small class="text-muted">مسح جميع البيانات المخزنة مؤقتًا على الخادم لتحديث واجهة المستخدم</small>
                    </div>
                    <div class="mb-3">
                        <button class="btn btn-info btn-block mb-2" data-toggle="modal" data-target="#backupModal">
                            <i class="fas fa-download"></i> إنشاء نسخة احتياطية
                        </button>
                        <small class="text-muted">إنشاء نسخة احتياطية كاملة من قاعدة البيانات والملفات المرفوعة</small>
                    </div>
                    <div class="mb-3">
                        <button class="btn btn-danger btn-block mb-2" data-toggle="modal" data-target="#maintenanceModal">
                            <i class="fas fa-tools"></i> وضع الصيانة
                        </button>
                        <small class="text-muted">تفعيل وضع الصيانة لمنع المستخدمين من الوصول إلى النظام مؤقتًا</small>
                    </div>
                    <hr>
                    <div>
                        <h6 class="font-weight-bold mb-3">معلومات النظام</h6>
                        <p class="mb-1">الإصدار: <span class="font-weight-bold">1.0.0</span></p>
                        <p class="mb-1">تاريخ آخر تحديث: <span class="font-weight-bold">{{ now.strftime('%Y-%m-%d') }}</span></p>
                        <p class="mb-1">حالة قاعدة البيانات: <span class="badge badge-success">متصلة</span></p>
                        <p class="mb-1">مساحة التخزين المستخدمة: <span class="font-weight-bold">1.2 جيجابايت</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Clear Cache Modal -->
<div class="modal fade" id="clearCacheModal" tabindex="-1" role="dialog" aria-labelledby="clearCacheModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="clearCacheModalLabel">تأكيد مسح ذاكرة التخزين المؤقت</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <p>هل أنت متأكد من رغبتك في مسح ذاكرة التخزين المؤقت؟ سيؤدي هذا إلى تحديث واجهة المستخدم وإعادة تحميل البيانات من قاعدة البيانات.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">إلغاء</button>
                <a class="btn btn-warning" href="#">
                    <i class="fas fa-broom"></i> تأكيد المسح
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Backup Modal -->
<div class="modal fade" id="backupModal" tabindex="-1" role="dialog" aria-labelledby="backupModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="backupModalLabel">إنشاء نسخة احتياطية</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <p>سيتم إنشاء نسخة احتياطية كاملة من قاعدة البيانات والملفات المرفوعة. هذه العملية قد تستغرق بعض الوقت حسب حجم البيانات.</p>
                <div class="form-group">
                    <label for="backup_description">وصف النسخة الاحتياطية (اختياري)</label>
                    <input type="text" class="form-control" id="backup_description" placeholder="مثال: نسخة قبل تحديث النظام">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">إلغاء</button>
                <a class="btn btn-info" href="#">
                    <i class="fas fa-download"></i> بدء النسخ الاحتياطي
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Maintenance Mode Modal -->
<div class="modal fade" id="maintenanceModal" tabindex="-1" role="dialog" aria-labelledby="maintenanceModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="maintenanceModalLabel">تفعيل وضع الصيانة</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i> تحذير: تفعيل وضع الصيانة سيمنع جميع المستخدمين من الوصول إلى النظام باستثناء المسؤولين.
                </div>
                <div class="form-group">
                    <label for="maintenance_message">رسالة الصيانة للمستخدمين</label>
                    <textarea class="form-control" id="maintenance_message" rows="3">نعتذر، النظام قيد الصيانة حاليًا. يرجى المحاولة لاحقًا.</textarea>
                </div>
                <div class="form-group">
                    <label for="maintenance_duration">مدة الصيانة المتوقعة (دقائق)</label>
                    <input type="number" class="form-control" id="maintenance_duration" value="30" min="5">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">إلغاء</button>
                <a class="btn btn-danger" href="#">
                    <i class="fas fa-tools"></i> تفعيل وضع الصيانة
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}